<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2025-11-20T03:00:00.000Z" agent="Mozilla/5.0" version="22.1.11" etag="enrollment-flow" type="device">
  <diagram name="Enrollment Flow" id="enrollment-sequence">
    <mxGraphModel dx="1434" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" background="#ffffff">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        
        <!-- Title -->
        <mxCell id="title" value="Face Recognition - Enrollment Sequence Diagram" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="800" height="40" as="geometry"/>
        </mxCell>
        
        <!-- Lifelines -->
        <mxCell id="client-lifeline" value="Client" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;fillColor=#E1D5E7;strokeColor=#9673A6;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="100" width="100" height="900" as="geometry"/>
        </mxCell>
        
        <mxCell id="api-lifeline" value="API Gateway" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;fillColor=#FFF2CC;strokeColor=#D6B656;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="280" y="100" width="120" height="900" as="geometry"/>
        </mxCell>
        
        <mxCell id="lambda-lifeline" value="EnrollFunction" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;fillColor=#FFE6CC;strokeColor=#D79B00;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="480" y="100" width="120" height="900" as="geometry"/>
        </mxCell>
        
        <mxCell id="s3-lifeline" value="S3 Bucket" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;fillColor=#D5E8D4;strokeColor=#82B366;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="680" y="100" width="100" height="900" as="geometry"/>
        </mxCell>
        
        <mxCell id="rek-lifeline" value="Rekognition" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;fillColor=#E8F5E9;strokeColor=#277116;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="860" y="100" width="120" height="900" as="geometry"/>
        </mxCell>
        
        <mxCell id="ddb-lifeline" value="DynamoDB" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;fillColor=#E3F2FD;strokeColor=#3334B9;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1060" y="100" width="100" height="900" as="geometry"/>
        </mxCell>
        
        <!-- Messages -->
        <mxCell id="msg1" value="1. POST /enroll (image, name, metadata)" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#8B5CF6;" edge="1" parent="1" source="client-lifeline" target="api-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="150" y="200" as="sourcePoint"/>
            <mxPoint x="340" y="200" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg2" value="2. Invoke Lambda" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#FF9900;" edge="1" parent="1" source="api-lifeline" target="lambda-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="340" y="240" as="sourcePoint"/>
            <mxPoint x="540" y="240" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg3" value="3. Decode Base64 &amp; Generate person_id" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=none;endFill=0;startArrow=none;startFill=0;strokeWidth=2;strokeColor=#666666;dashed=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="540" y="280" as="sourcePoint"/>
            <mxPoint x="540" y="310" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg4" value="4. Upload image" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#82B366;" edge="1" parent="1" source="lambda-lifeline" target="s3-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="540" y="350" as="sourcePoint"/>
            <mxPoint x="730" y="350" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg5" value="5. S3 URL" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#82B366;dashed=1;" edge="1" parent="1" source="s3-lifeline" target="lambda-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="730" y="390" as="sourcePoint"/>
            <mxPoint x="540" y="390" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg6" value="6. IndexFaces(image, collection_id)" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#277116;" edge="1" parent="1" source="lambda-lifeline" target="rek-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="540" y="430" as="sourcePoint"/>
            <mxPoint x="920" y="430" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg7" value="7. Extract 512-dim embedding" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=none;endFill=0;startArrow=none;startFill=0;strokeWidth=2;strokeColor=#666666;dashed=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="920" y="470" as="sourcePoint"/>
            <mxPoint x="920" y="500" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg8" value="8. face_id, confidence, bounding_box" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#277116;dashed=1;" edge="1" parent="1" source="rek-lifeline" target="lambda-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="920" y="540" as="sourcePoint"/>
            <mxPoint x="540" y="540" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg9" value="9. PutItem Users table" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#3334B9;" edge="1" parent="1" source="lambda-lifeline" target="ddb-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="540" y="580" as="sourcePoint"/>
            <mxPoint x="1110" y="580" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg10" value="10. Success" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#3334B9;dashed=1;" edge="1" parent="1" source="ddb-lifeline" target="lambda-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1110" y="620" as="sourcePoint"/>
            <mxPoint x="540" y="620" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg11" value="11. PutItem Embeddings table" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#3334B9;" edge="1" parent="1" source="lambda-lifeline" target="ddb-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="540" y="660" as="sourcePoint"/>
            <mxPoint x="1110" y="660" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg12" value="12. Success" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#3334B9;dashed=1;" edge="1" parent="1" source="ddb-lifeline" target="lambda-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1110" y="700" as="sourcePoint"/>
            <mxPoint x="540" y="700" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg13" value="13. Success Response" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#FF9900;dashed=1;" edge="1" parent="1" source="lambda-lifeline" target="api-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="540" y="740" as="sourcePoint"/>
            <mxPoint x="340" y="740" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="msg14" value="14. {person_id, face_id, confidence}" style="edgeStyle=orthogonalEdgeStyle;html=1;align=center;verticalAlign=middle;endArrow=block;endFill=1;strokeWidth=2;strokeColor=#8B5CF6;dashed=1;" edge="1" parent="1" source="api-lifeline" target="client-lifeline">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="340" y="780" as="sourcePoint"/>
            <mxPoint x="150" y="780" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        
        <!-- Notes -->
        <mxCell id="note1" value="Note: All operations logged to CloudWatch" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#FFF9E6;strokeColor=#F9A825;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1200" y="200" width="180" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="note2" value="Error Handling:&#xa;- No face: 400 error&#xa;- Multiple faces: 400 error&#xa;- Poor quality: Retry" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#F8CECC;strokeColor=#C7131F;fontSize=12;align=left;" vertex="1" parent="1">
          <mxGeometry x="1200" y="300" width="180" height="100" as="geometry"/>
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1200" y="450" width="180" height="200" as="geometry"/>
        </mxCell>
        
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1200" y="460" width="180" height="30" as="geometry"/>
        </mxCell>
        
        <mxCell id="legend-1" value="→ Synchronous call" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1210" y="500" width="160" height="20" as="geometry"/>
        </mxCell>
        
        <mxCell id="legend-2" value="⤺ Response" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1210" y="530" width="160" height="20" as="geometry"/>
        </mxCell>
        
        <mxCell id="legend-3" value="Purple: Client-API" style="text;html=1;strokeColor=none;fillColor=#E1D5E7;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1210" y="560" width="160" height="20" as="geometry"/>
        </mxCell>
        
        <mxCell id="legend-4" value="Blue: Database ops" style="text;html=1;strokeColor=none;fillColor=#E3F2FD;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1210" y="590" width="160" height="20" as="geometry"/>
        </mxCell>
        
        <mxCell id="legend-5" value="Green: AI/ML services" style="text;html=1;strokeColor=none;fillColor=#E8F5E9;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1210" y="620" width="160" height="20" as="geometry"/>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
